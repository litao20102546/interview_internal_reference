# 数据库查询优化

## 性能瓶颈定位

Mysql> show status —— 显示状态信息（扩展show status like ‘XXX’）

Mysql> show variables —— 显示系统变量（扩展show variables like ‘XXX’）

Mysql> show innodb status —— 显示InnoDB存储引擎的状态

Mysql> show processlist —— 查看当前SQL执行，包括执行状态、是否锁表等

Shell> mysqladmin variables -u username -p password —— 显示系统变量

Shell> mysqladmin extended-status -u username -p password —— 显示状态信息

我常用的主要有show status和show processlist。

## **慢查询日志分析法**

慢查询日志开启方法有两种，具体如下：

方法1：在配置文件 my.cnf 或 my.ini 中在[mysqld]一行下面加入两个配置参数：

log-slow-queries=/data/mysqldata/slow-query.log
1
（注：log-slow-queries参数为慢查询日志存放的位置）

long_query_time=2
1
（注：long_query_time=2中的2表示查询超过两秒才记录）

方法2：通过命令行设置变量来即时启动慢日志查询

## **explain（执行计划）分析查询**

通过explain命令可以得到:
– 表的读取顺序
– 数据读取操作的操作类型
– 哪些索引可以使用
– 哪些索引被实际使用
– 表之间的引用
– 每张表有多少行被优化器查询

